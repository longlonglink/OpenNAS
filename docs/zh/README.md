---
title: OpenNAS 项目
---

# OpenNAS 开源项目

OpenNAS 是一个基于 FPGA 的高性能、低功耗开源网络附加存储（NAS）项目。本项目采用完全开源的设计理念，从硬件到软件，从固件到应用，所有代码和设计文档都向社区开放，致力于帮助用户重新掌控自己的数据主权。

## 硬件

### 1. 主控芯片

我们选择使用 **Xilinx Zynq-7000 系列 FPGA** 作为核心处理器，具体型号为 **XC7Z035-FFG900**。

#### 为什么选择 FPGA？

- **可定制性**：FPGA 的硬件可编程特性允许我们针对存储和网络应用进行深度优化
- **高性能**：通过硬件加速，可以实现远超传统 ARM 或 x86 处理器的 I/O 性能
- **低功耗**：相比同等性能的通用处理器，FPGA 在特定应用场景下功耗更低
- **开源友好**：FPGA 设计可以使用开源工具链进行开发和验证

#### 技术规格

- **逻辑单元**：XC7Z035 提供 275K 逻辑单元，足以实现复杂的存储和网络协议栈
- **ARM 双核 Cortex-A9**：运行 Linux 操作系统和上层应用
- **DDR3 控制器**：支持高速内存访问
- **PCIe 接口**：用于连接 NVMe 存储设备

### 2. 网络接口（SFP+）

OpenNAS 提供 **4 路 10Gbps 以太网接口**，通过 SFP+ 光模块实现高速网络连接。

#### 设计特点

- **10Gbps 带宽**：每路接口支持 10Gbps 全双工通信，总带宽可达 40Gbps
- **SFP+ 接口**：支持多种光模块和直连铜缆，灵活适配不同网络环境
- **硬件加速**：网络协议处理在 FPGA 硬件中实现，降低 CPU 负载
- **低延迟**：硬件实现的网络栈可以实现微秒级的延迟

#### 应用场景

- 高速文件传输和备份
- 媒体内容分发


### 3. 存储接口（NVMe）

OpenNAS 通过 **PCIe 软核**实现对 NVMe 固态硬盘的直接访问。

#### 技术实现

- **PCIe 软核**：使用 Xilinx GT（Gigabit Transceiver）和 RTL 代码实现 PCIe 协议栈
- **NVMe 协议支持**：完整的 NVMe 1.4 协议实现，支持多队列、命名空间等高级特性
- **多盘支持**：可同时连接多块 NVMe SSD，实现 RAID 或独立存储池
- **高性能**：直接硬件访问，避免传统存储栈的开销

#### 性能优势

- **低延迟**：硬件实现的 PCIe 和 NVMe 协议栈，延迟可低至微秒级
- **高吞吐**：充分利用 NVMe SSD 的并行性能
- **可扩展**：通过 PCIe 扩展可以支持更多存储设备

#### 开源设计

- **RTL 代码开源**：所有 PCIe 和 NVMe 相关的 RTL 代码完全开源
- **可定制**：社区可以根据需求修改和优化存储协议实现
- **透明性**：用户可以完全了解数据是如何被存储和访问的

## 软件

### 系统架构

OpenNAS 软件栈采用分层设计，从底层到上层包括：

#### 1. 操作系统层

- **Linux 内核**：基于主线 Linux 内核，针对存储和网络应用进行优化
- **设备驱动**：为 FPGA 硬件提供完整的驱动支持
- **资源管理**：高效的 CPU、内存和 I/O 资源调度

#### 2. 存储管理层

- **文件系统**：支持多种现代文件系统（ZFS、Btrfs 等）
- **存储池管理**：灵活的存储池配置和管理
- **数据保护**：RAID、快照、备份等数据保护机制
- **性能优化**：智能缓存、预读、写入合并等优化策略

#### 3. 网络服务层

- **文件共享协议**：支持 SMB、NFS、FTP、SFTP 等主流协议
- **Web 管理界面**：现代化的 Web UI，方便远程管理
- **安全认证**：完整的用户权限管理和访问控制

#### 4. 应用服务层

- **媒体服务器**：支持 Plex、Jellyfin 等媒体服务器
- **云同步**：支持 Nextcloud、ownCloud 等私有云方案
- **容器支持**：Docker 容器化部署应用
- **Web 3.0 应用**：去中心化存储和内容发布功能

### Web 3.0 特性

OpenNAS 不仅是存储器，更是个人多媒体发布平台：

- **去中心化内容发布**：支持 IPFS、ActivityPub 等去中心化协议
- **内容自主权**：用户完全控制自己的内容和数据
- **摆脱平台束缚**：不依赖中心化平台，自由发布和分享内容
- **隐私保护**：内容存储在本地，用户决定分享范围

### 开源生态

- **完全开源**：所有软件代码在开源许可证下发布
- **社区驱动**：欢迎社区贡献代码和功能
- **文档完善**：提供详细的技术文档和开发指南
- **易于扩展**：模块化设计，方便添加新功能

## 固件

### TCP Offload Engine (TOE)

OpenNAS 在 FPGA 中实现了 **TCP 卸载引擎（TOE）**，将 TCP 协议处理从 CPU 转移到硬件，大幅提升网络性能。

#### 技术优势

- **CPU 卸载**：TCP 协议栈在 FPGA 硬件中实现，释放 CPU 资源用于其他任务
- **低延迟**：硬件实现的 TCP 处理，延迟远低于软件实现
- **高吞吐**：可以轻松达到 10Gbps 线速转发
- **低功耗**：专用硬件比通用 CPU 处理网络协议更节能

#### 实现特性

- **完整 TCP/IP 协议栈**：支持 TCP、UDP、ICMP 等协议
- **连接管理**：支持大量并发连接
- **流量控制**：硬件实现的拥塞控制和流量整形
- **安全功能**：支持 IPsec、TLS 卸载等安全加速

### 其他固件特性

#### 1. 存储加速

- **NVMe 队列管理**：硬件实现的命令队列和完成队列
- **DMA 引擎**：高效的数据传输机制
- **缓存管理**：智能的读写缓存策略

#### 2. 网络加速

- **数据包处理**：硬件实现的包分类、过滤和转发
- **负载均衡**：多路网络接口的负载均衡
- **QoS 保证**：服务质量保证机制

#### 3. 能效优化


- **热管理**：可以通过温度监控来实现风扇转速调节

### 开源固件

- **RTL 代码完全开源**：所有 FPGA 固件代码开源
- **开发工具链**：目前先使用Vivado，未来计划支持开源 FPGA 工具链（如 Yosys、nextpnr）
- **仿真和验证**：提供完整的测试平台和验证环境
- **文档和教程**：详细的固件开发文档

## 项目目标

### 技术目标

- **高性能**：实现 10Gbps 网络吞吐和微秒级延迟
- **低功耗**：在同等性能下，功耗低于传统方案 50% 以上
- **高可靠性**：7×24 小时稳定运行，数据零丢失
- **易用性**：开箱即用，配置简单

### 开源目标

- **完全透明**：硬件、软件、固件全部开源
- **社区共建**：欢迎全球开发者参与贡献
- **知识共享**：所有设计文档和技术细节公开
- **持续改进**：基于社区反馈不断优化和完善

### 应用场景

- **个人数据存储**：家庭 NAS，个人云存储
- **小型企业存储**：小型企业文件服务器
- **媒体中心**：家庭媒体服务器，内容分发
- **开发测试**：开发者的测试存储环境
- **边缘计算**：边缘节点的存储和计算平台

## 参与贡献

OpenNAS 是一个完全开源的项目，我们欢迎所有形式的贡献：

- **代码贡献**：硬件设计、软件开发、固件优化
- **文档完善**：技术文档、用户手册、教程
- **测试反馈**：bug 报告、性能测试、使用体验
- **社区支持**：回答问题、帮助新用户、推广项目

让我们一起构建一个真正属于用户的开源存储解决方案！
